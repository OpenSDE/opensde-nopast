# --- SDE-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# Filename: lib/sde-package/update.in
# Copyright (C) 2006 The OpenSDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- SDE-COPYRIGHT-NOTE-END ---

package_do_update() {
	cd "$SDEROOT"
	echo_info "Updating '$1' ${2:+to version $2.}"
	$SDEROOT/lib/sde-package/update.sh "$1" "${2:-refresh}"
}

package_update() {
	local pkg= ver=

	if [ $# -eq 2 ]; then
		# package and version
		pkg="$1"
		ver="$2"
	elif [ $# -eq 1 ]; then
		# package or verion?
		if [ -d "$( echo "$SDEROOT/package/"*"/$1/" )" ]; then
			pkg="$1"
		else
			pkg="$( package_autodetect )"
			ver="$1"
		fi
	elif [ $# -eq 0 ]; then
		# can i refresh an autodetected package?
		pkg=$( package_autodetect )
	else
		echo_error "Invalid Syntax."
		package_usage
		return 1	
	fi

	if [ -n "$pkg" ]; then
		package_do_update "$pkg" "$ver"
	else
		echo_error "I could't guess which package you want to update."
		package_usage
		return 2
	fi
}
