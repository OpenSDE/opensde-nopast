#!patch
# --- T2-COPYRIGHT-NOTE-BEGIN ---
# This copyright note is auto-generated by ./scripts/Create-CopyPatch.
# 
# T2 SDE: target/share/livecd/rootfs/sbin/init.d/system
# Copyright (C) 2006 The T2 SDE Project
# 
# More information can be found in the files COPYING and README.
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License. A copy of the
# GNU General Public License can be found in the file COPYING.
# --- T2-COPYRIGHT-NOTE-END ---

--- system.vanilla	2005-11-07 01:45:58.000000000 +0100
+++ system	2005-11-07 01:47:13.000000000 +0100
@@ -66,6 +66,14 @@
 
 	title "Activating swap devices."
 	swapon -a || error=$?
+	for x in /dev/{hd,sd}??*; do
+		[ -e $x ] || continue
+		if disktype $x | grep -q Swap &&
+		   ! grep -q $x /proc/swaps; then
+			echo "Discovered swap space on $x, activating."
+			swapon $x
+		fi
+	done
     	status
 
 	title "Checking file systems."
@@ -88,7 +88,9 @@
     	status
 
 	title "Mounting local file systems."
+if false; then
 	mount -n -o remount,rw / || error=$?
+fi
 	cat /proc/mounts > /etc/mtab
 	mount -a -t nocoda,nfs,devfs,proc,sysfs || error=$?
     	status
 
